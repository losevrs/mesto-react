(this["webpackJsonpmesto-react-func"]=this["webpackJsonpmesto-react-func"]||[]).push([[0],{11:function(e,t,n){e.exports=n(17)},16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(6),c=n.n(r),i=(n(16),n(4)),l=n(1),u=n(7),s=n.n(u),p=function(e){return o.a.createElement("header",{className:"header"},o.a.createElement("img",{className:"header__logo",src:s.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f"}))},m=n(8),d=n.n(m),_=function(e){var t=o.a.useState(!1),n=Object(l.a)(t,2),a=n[0],r=n[1];o.a.useEffect((function(){r(!1)}),[e.src]);return o.a.createElement("img",{className:e.className,src:a?d.a:e.src,alt:e.alt,onError:function(){r(!0)},onClick:e.onClick})},f=o.a.createContext(),v=function(){return Object(a.useContext)(f)},h=function(e){return o.a.createElement(f.Provider,{value:e.value},e.children)},E=function(e){var t=v(),n=e.card.owner._id===t._id,a=e.card.likes.some((function(e){return e._id===t._id}));return o.a.createElement("div",{className:"photocard"},o.a.createElement(_,{className:"photocard__viewport",src:e.card.link,alt:"\u0424\u043e\u0442\u043e \u043c\u0435\u0441\u0442\u0430",onClick:function(){e.onCardClick(e.card)},onError:null}),o.a.createElement("button",{className:"photocard__delete ".concat(n&&"photocard__delete_show"),type:"button",onClick:function(){e.onCardDelete(e.card)}}),o.a.createElement("div",{className:"photocard__description"},o.a.createElement("h2",{className:"photocard__placename"},e.card.name),o.a.createElement("div",{className:"photocard__likes"},o.a.createElement("button",{className:"photocard__like ".concat(a&&"photocard__like_on"),type:"button",onClick:function(){e.onCardLike(e.card)}}),o.a.createElement("span",{className:"photocard__count"},e.card.likes.length))))},b=function(e){var t=e.onAddPlace.bind(void 0),n=e.onEditProfile.bind(void 0),a=e.onEditAvatar.bind(void 0),r=v();return o.a.createElement("main",{className:"main"},o.a.createElement("section",{className:"profile ".concat(e.isHidden&&"profile_hidden")},o.a.createElement("div",{className:"profile__avatar-overlay",onClick:a},o.a.createElement(_,{className:"profile__avatar",src:r.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"})),o.a.createElement("div",{className:"profile__info"},o.a.createElement("div",{className:"profile__title"},o.a.createElement("h1",{className:"profile__name"},r.name),o.a.createElement("button",{className:"profile__editbutton",onClick:n,type:"button"})),o.a.createElement("p",{className:"profile__about"},r.about)),o.a.createElement("button",{className:"profile__addbutton",onClick:t,type:"button"})),o.a.createElement("section",{className:"placesphotos"},e.cards.map((function(t){return o.a.createElement(E,{key:t._id,card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete})}))))},C=function(e){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))},k=function(e){var t=o.a.useRef(null),n=o.a.useCallback((function(t){"Escape"===t.key&&e.onClose()}),[]);return o.a.useEffect((function(){e.isOpened?document.addEventListener("keydown",n):document.removeEventListener("keydown",n)}),[e.isOpened]),o.a.createElement("section",{className:"popup popup_".concat(e.name," ").concat(e.isOpened&&"popup_opened"),onClick:function(n){n.target===t.current&&e.onClose()},ref:t},e.children)},N=function(e){return o.a.createElement(k,{name:e.name,isOpened:e.isOpened,onClose:e.onClose},o.a.createElement("form",{className:"popup__container",action:"#",method:"POST",name:"".concat(e.name),noValidate:!0,onSubmit:e.onSubmit},o.a.createElement("h2",{className:"popup__title"},"".concat(e.title)),e.children,o.a.createElement("button",{className:"popup__submit",type:"submit"},e.buttonTitle),o.a.createElement("button",{className:"popup__reset",type:"button",onClick:e.onClose})))},O=function(e){var t=v(),n=o.a.useState(t.name),a=Object(l.a)(n,2),r=a[0],c=a[1],i=o.a.useState(t.about),u=Object(l.a)(i,2),s=u[0],p=u[1];o.a.useEffect((function(){c(t.name),p(t.about)}),[t]);return o.a.createElement(N,{name:"profileedit",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonTitle:e.buttonTitle,isOpened:e.isOpened,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:r,about:s})}},o.a.createElement("input",{className:"popup__input popup__input_name popup__input_top",type:"text",name:"name",placeholder:"\u0418\u043c\u044f",value:r,onChange:function(e){c(e.target.value)},required:!0,minLength:"2",maxLength:"40"}),o.a.createElement("span",{id:"popup__input_name_error",className:"popup__input_type_error"}),o.a.createElement("input",{className:"popup__input popup__input_about",type:"text",name:"about",onChange:function(e){p(e.target.value)},placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",value:s,required:!0,minLength:"2",maxLength:"200"}),o.a.createElement("span",{id:"popup__input_about_error",className:"popup__input_type_error"}))},g=function(e){var t=Object(a.useRef)(null);return o.a.createElement(N,{name:"newavatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonTitle:e.buttonTitle,isOpened:e.isOpened,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})}},o.a.createElement("input",{className:"popup__input popup__input_avatar  popup__input_top",type:"url",name:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",ref:t,required:!0}),o.a.createElement("span",{id:"popup__input_avatar_error",className:"popup__input_type_error"}))},y=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(""),u=Object(l.a)(i,2),s=u[0],p=u[1];return o.a.createElement(N,{name:"newplace",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",buttonTitle:e.buttonTitle,isOpened:e.isOpened,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onCreateCard({name:r,link:s})}},o.a.createElement("input",{className:"popup__input popup__input_photoname popup__input_top",type:"text",name:"photoName",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",value:r,onChange:function(e){c(e.target.value)},required:!0,minLength:"1",maxLength:"30"}),o.a.createElement("span",{id:"popup__input_photoName_error",className:"popup__input_type_error"}),o.a.createElement("input",{className:"popup__input popup__input_photourl",type:"url",name:"photoUrl",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",value:s,onChange:function(e){p(e.target.value)},required:!0}),o.a.createElement("span",{id:"popup__input_photoUrl_error",className:"popup__input_type_error"}))},j=function(e){return o.a.createElement(N,{name:"confirm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonTitle:e.buttonTitle,isOpened:e.isOpened,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onConfirm()}})},S=function(e){return o.a.createElement(k,{name:"view",isOpened:e.isOpened,onClose:e.onClose},o.a.createElement("div",{className:"popup__photoview"},o.a.createElement(_,{className:"popup__image",alt:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0444\u043e\u0442\u043e",src:e.card.link}),o.a.createElement("h2",{className:"popup__imagetitle"},e.card.name),o.a.createElement("button",{className:"popup__reset",type:"button",onClick:e.onClose})))},T=n(9),w=n(10),L=new(function(){function e(t){Object(T.a)(this,e),this._options=t}return Object(w.a)(e,[{key:"_serverRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return fetch(this._options.baseUrl+e,{method:t,headers:{authorization:this._options.headers.authorization,"Content-Type":this._options.headers["Content-Type"]},body:JSON.stringify(n)}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return this._serverRequest("users/me")}},{key:"saveProfile",value:function(e){return this._serverRequest("users/me","PATCH",e)}},{key:"saveAvatar",value:function(e){return this._serverRequest("users/me/avatar","PATCH",e)}},{key:"getInitialCards",value:function(){return this._serverRequest("cards")}},{key:"saveCard",value:function(e){return this._serverRequest("cards","POST",e)}},{key:"deleteCard",value:function(e){return this._serverRequest("cards/"+e,"DELETE")}},{key:"like",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t?"PUT":"DELETE";return this._serverRequest("cards/likes/"+e,n)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-14/",headers:{authorization:"44e5d6af-1500-4757-9283-b4dfbe9e13fc","Content-Type":"application/json"}}),P=function(){var e=o.a.useState(!1),t=Object(l.a)(e,2),n=t[0],a=t[1],r=o.a.useState(!1),c=Object(l.a)(r,2),u=c[0],s=c[1],m=o.a.useState(!1),d=Object(l.a)(m,2),_=d[0],f=d[1],v=o.a.useState(!1),E=Object(l.a)(v,2),k=E[0],N=E[1],T=o.a.useState(!1),w=Object(l.a)(T,2),P=w[0],q=w[1],U=o.a.useState({}),x=Object(l.a)(U,2),R=x[0],A=x[1],D=o.a.useState({name:"",about:""}),I=Object(l.a)(D,2),H=I[0],z=I[1],J=o.a.useState([]),B=Object(l.a)(J,2),M=B[0],W=B[1],G=o.a.useState(!0),V=Object(l.a)(G,2),$=V[0],F=V[1],K=o.a.useState(!1),Q=Object(l.a)(K,2),X=Q[0],Y=Q[1];o.a.useEffect((function(){Promise.all([L.getUserInfo(),L.getInitialCards()]).then((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];z(n),W(a)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 : "+e)})).finally((function(){F(!1)}))}),[]);var Z=function(){a(!1),s(!1),f(!1),N(!1),q(!1),Y(!1),A({})};return o.a.createElement("div",{className:"page"},o.a.createElement(h,{value:H},o.a.createElement(p,null),o.a.createElement(b,{onEditProfile:function(){a(!0)},onAddPlace:function(){s(!0)},onEditAvatar:function(){f(!0)},onCardClick:function(e){A(e),N(!0)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===H._id}));L.like(e._id,!t).then((function(t){var n=M.map((function(n){return n._id===e._id?t:n}));W(n)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u043b\u0430\u0439\u043a\u0430 : "+e)}))},onCardDelete:function(e){A(e),q(!0)},isHidden:$,cards:M}),o.a.createElement(C,null),o.a.createElement(O,{isOpened:n,onClose:Z,onUpdateUser:function(e){var t=e.name,n=e.about;Y(!0),L.saveProfile({name:t,about:n}).then((function(e){z(e)})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f : ",e)})).finally((function(){Z()}))},buttonTitle:X?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),o.a.createElement(g,{isOpened:_,onClose:Z,onUpdateAvatar:function(e){var t=e.avatar;Y(!0),L.saveAvatar({avatar:t}).then((function(e){z(e)})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0430\u0432\u0430\u0442\u0430\u0440\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f : ",e)})).finally((function(){Z()}))},value:H.avatar,buttonTitle:X?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),o.a.createElement(y,{isOpened:u,onClose:Z,onCreateCard:function(e){Y(!0),L.saveCard(e).then((function(e){e&&W([e].concat(Object(i.a)(M)))})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 : ",e)})).finally((function(){Z()}))},buttonTitle:X?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),o.a.createElement(j,{onConfirm:function(){Y(!0),L.deleteCard(R._id).then((function(){var e=Object(i.a)(M),t=e.findIndex((function(e){return e._id===R._id}));t>=0&&(e.splice(t,1),W(e))})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438 : "+e)})).finally((function(){Z()}))},onClose:Z,isOpened:P,buttonTitle:X?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0414\u0430"}),o.a.createElement(S,{card:R,isOpened:k,onClose:Z})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,n){e.exports=n.p+"static/media/logo.c6f11019.svg"},8:function(e,t,n){e.exports=n.p+"static/media/onerror.a6166131.jpg"}},[[11,1,2]]]);
//# sourceMappingURL=main.1079980e.chunk.js.map